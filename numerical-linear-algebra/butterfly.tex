\documentclass[uplatex,a4j]{jsarticle}
\usepackage[dvipdfmx]{graphicx}
\usepackage{amsmath,ascmac}
\usepackage{bm}
\usepackage{algorithm,algorithmic}
\usepackage{listings}
\usepackage{subcaption}
\usepackage{amsfonts}
\lstset{%
  language={C},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}
\renewcommand{\lstlistingname}{コード}
\renewcommand{\lstlistlistingname}{コード目次}
\renewcommand{\thesubsection}{(\arabic{subsection})}
\renewcommand{\thesection}{課題\arabic{section}}

% ***************ここ変える*****************
\title{数値線形代数レポート}
\author{1029 36 1263 天野塁}
\date{2025/10/27}
% ****************************************

\begin{document}

\maketitle

\section{消去法を用いた連立一次方程式の解法}
\label{sec:q1}

\subsection{データのプロット}
\label{sec:q1_1}

大きさが$n = 100,200,400,800$の対角行列$A$とベクトル$\bm{b}$の組を100個ずつ生成して, 
それぞれのペアに対して消去法を用いて連立一次方程式
\begin{align}
  A \bm{x} = \bm{b}
\end{align}
の数値解を計算した. \\
各$n$に対する数値解$\bm{\tilde{x}}$の残差ノルム$\| \bm{b} - A \bm{\tilde{x}} \|$, 
真の解$\bm{x}$との相対誤差$\frac{\| \bm{x} - \bm{\tilde{x}} \|}{\| \bm{x} \|}$, 計算時間は
それぞれ図\ref{fig:q1_rn}, 図\ref{fig:q1_re}, 図\ref{fig:q1_ct}の通り. 
それぞれのグラフの直線はデータの中央値を表している.

\begin{figure}[htbp]
  \centering

  \begin{minipage}[t]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{question1/q1_residual_norm.png}
    \captionof{figure}{残差ノルム}
    \label{fig:q1_rn}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{question1/q1_relative_error.png}
    \captionof{figure}{相対誤差}
    \label{fig:q1_re}
  \end{minipage}
  
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.48\textwidth]{question1/q1_calculation_time.png}
  \caption{計算時間}
  \label{fig:q1_ct}
\end{figure}

\newpage
\subsection{数値解の精度と次数$n$の関係}
\label{sec:q1_2}
図\ref{fig:q1_rn}, 図\ref{fig:q1_re}において各$n$における中央値の幅が一定なことから, 
残差ノルム及び相対誤差は多項式のオーダーで増加していると読み取れる. 
消去法の計算量は$O(n^3)$であり, 計算の丸め誤差が$O(n^3)$で蓄積されていくので, このような結果になったと考えられる.

\subsection{計算時間と次数$n$の関係}
\label{sec:q1_3}
図\ref{fig:q1_ct}において各$n$における中央値の幅が概ね一定なことから, 
計算時間は多項式のオーダーで増加していると読み取れる. 
さらに図\ref{fig:q1_rn}, 図\ref{fig:q1_re}と比べてデータのばらつきが大幅に少なくなっている.
消去法の計算量は$O(n^3)$であり, 最初の行列及びベクトルにはよらないので, このような結果になったと考えられる.


\section{LU分解を用いた連立一次方程式の解法}
\label{sec:q2}

\subsection{データのプロット}
\label{sec:q2_1}

大きさが$n = 100,200,400,800$の対角行列$A$とベクトル$\bm{b}$の組を100個ずつ生成して, 
それぞれのペアに対してLU分解を用いて連立一次方程式
\begin{align}
  A \bm{x} = \bm{b}
\end{align}
の数値解を計算した. \\
各$n$に対する数値解$\bm{\tilde{x}}$の残差ノルム$\| \bm{b} - A \bm{\tilde{x}} \|$, 
真の解$\bm{x}$との相対誤差$\frac{\| \bm{x} - \bm{\tilde{x}} \|}{\| \bm{x} \|}$, 計算時間は
それぞれ図\ref{fig:q1_rn}, 図\ref{fig:q1_re}, 図\ref{fig:q1_ct}の通り. 
それぞれのグラフの直線はデータの中央値を表している.

\begin{figure}[htbp]
  \centering

  \begin{minipage}[t]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{question2/q2_residual_norm.png}
    \captionof{figure}{残差ノルム}
    \label{fig:q2_rn}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{question2/q2_relative_error.png}
    \captionof{figure}{相対誤差}
    \label{fig:q2_re}
  \end{minipage}
  
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.48\textwidth]{question2/q2_calculation_time.png}
  \caption{計算時間}
  \label{fig:q2_ct}
\end{figure}

\newpage
\subsection{数値解の精度と次数$n$の関係}
\label{sec:q2_2}
図\ref{fig:q2_rn}, 図\ref{fig:q2_re}において各$n$における中央値の幅が一定なことから, 
残差ノルム及び相対誤差は多項式のオーダーで増加していると読み取れる. 
LU分解の計算量は$O(n^3)$であり, 計算の丸め誤差が$O(n^3)$で蓄積されていくので, このような結果になったと考えられる.

\subsection{計算時間と次数$n$の関係}
\label{sec:q2_3}
図\ref{fig:q2_ct}において各$n$における中央値の幅が概ね一定なことから, 
計算時間は多項式のオーダーで増加していると読み取れる. 
さらに図\ref{fig:q2_rn}, 図\ref{fig:q2_re}と比べてデータのばらつきが大幅に少なくなっている.
LU分解の計算量は$O(n^3)$であり, 最初の行列及びベクトルにはよらないので, このような結果になったと考えられる.


\section{消去法とLU分解の比較}
図\ref{fig:q1_rn}と\ref{fig:q2_rn}, \ref{fig:q1_re}と\ref{fig:q2_re}, 
\ref{fig:q1_ct}と\ref{fig:q2_ct}の中央値を比較するとどれも概ね等しいので, 
消去法とLU分解で数値解の精度と計算速度は変わらないと読み取れる. 
実際どちらの方法においても, ボトルネックになっている計算はピボットを用いた掃き出しであり, 
それは加減算と除算をそれぞれ$O(n^3)$回ずつ行うものである. 
そのため消去法とLU分解で差が見られないと考えられる. 




\end{document}